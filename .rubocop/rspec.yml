---
plugins:
  - rubocop-rspec
  - rubocop-capybara
  - rubocop-factory_bot
  - rubocop-rspec_rails

RSpec:
  Enabled: true
  Include: &1
    - "**/*_spec.rb"
    - "**/spec/**/*"
  Language: &2
    inherit_mode:
      merge:
        - Expectations
        - Helpers
        - Hooks
        - HookScopes
        - Runners
        - Subjects
    ExampleGroups:
      inherit_mode:
        merge:
          - Regular
          - Skipped
          - Focused
      Regular:
        - describe
        - context
        - feature
        - example_group
      Skipped:
        - xdescribe
        - xcontext
        - xfeature
      Focused:
        - fdescribe
        - fcontext
        - ffeature
    Examples:
      inherit_mode:
        merge:
          - Regular
          - Skipped
          - Focused
          - Pending
      Regular:
        - it
        - specify
        - example
        - scenario
        - its
      Focused:
        - fit
        - fspecify
        - fexample
        - fscenario
        - focus
      Skipped:
        - xit
        - xspecify
        - xexample
        - xscenario
        - skip
      Pending:
        - pending
    Expectations:
      - expect
      - is_expected
      - expect_any_instance_of
    Helpers:
      - let
      - let!
    Hooks:
      - prepend_before
      - before
      - append_before
      - around
      - prepend_after
      - after
      - append_after
    HookScopes:
      - each
      - example
      - context
      - all
      - suite
    Includes:
      inherit_mode:
        merge:
          - Examples
          - Context
      Examples:
        - it_behaves_like
        - it_should_behave_like
        - include_examples
      Context:
        - include_context
    Runners:
      - to
      - to_not
      - not_to
    SharedGroups:
      inherit_mode:
        merge:
          - Examples
          - Context
      Examples:
        - shared_examples
        - shared_examples_for
      Context:
        - shared_context
    Subjects:
      - subject
      - subject!

RSpec/AlignLeftLetBrace:
  Description: Checks that left braces for adjacent single line lets are aligned.
  Enabled: false

RSpec/AlignRightLetBrace:
  Description: Checks that right braces for adjacent single line lets are aligned.
  Enabled: false

RSpec/AnyInstance:
  Description: Check that instances are not being stubbed globally.
  Enabled: true

RSpec/AroundBlock:
  Description: Checks that around blocks actually run the test.
  Enabled: true

RSpec/Be:
  Description: Check for expectations where `be` is used without argument.
  Enabled: true

RSpec/BeEql:
  Description: Check for expectations where `be(...)` can replace `eql(...)`.
  Enabled: true

RSpec/BeforeAfterAll:
  Description: Check that before/after(:all) isn't being used.
  Enabled: true
  Exclude:
    - spec/spec_helper.rb
    - spec/rails_helper.rb
    - spec/support/**/*.rb

RSpec/ContextMethod:
  Description: "`context` should not be used for specifying methods."
  Enabled: true

RSpec/ContextWording:
  Description: Checks that `context` docstring starts with an allowed prefix.
  Enabled: true
  Prefixes:
    - when
    - with
    - without

RSpec/DescribeClass:
  Description: Check that the first argument to the top-level describe is a constant.
  Enabled: true
  Exclude:
    - "**/spec/features/**/*"
    - "**/spec/requests/**/*"
    - "**/spec/routing/**/*"
    - "**/spec/system/**/*"
    - "**/spec/views/**/*"
  IgnoredMetadata:
    type:
      - channel
      - controller
      - helper
      - job
      - mailer
      - model
      - request
      - routing
      - view
      - feature
      - system
      - mailbox
      - aruba
      - task

RSpec/DescribeMethod:
  Description: Checks that the second argument to `describe` specifies a method.
  Enabled: true

RSpec/DescribeSymbol:
  Description: Avoid describing symbols.
  Enabled: true

RSpec/DescribedClass:
  Description: Checks that tests use `described_class`.
  Enabled: true
  SkipBlocks: false
  EnforcedStyle: described_class
  SupportedStyles:
    - described_class
    - explicit
  SafeAutoCorrect: false

RSpec/DescribedClassModuleWrapping:
  Description: Avoid opening modules and defining specs within them.
  Enabled: false

RSpec/Dialect:
  Description: This cop enforces custom RSpec dialects.
  Enabled: false
  PreferredMethods: {}

RSpec/EmptyExampleGroup:
  Description: Checks if an example group does not include any tests.
  Enabled: true

RSpec/EmptyHook:
  Description: Checks for empty before and after hooks.
  Enabled: true

RSpec/EmptyLineAfterExample:
  Description: Checks if there is an empty line after example blocks.
  Enabled: true
  AllowConsecutiveOneLiners: true

RSpec/EmptyLineAfterExampleGroup:
  Description: Checks if there is an empty line after example group blocks.
  Enabled: true

RSpec/EmptyLineAfterFinalLet:
  Description: Checks if there is an empty line after the last let block.
  Enabled: true

RSpec/EmptyLineAfterHook:
  Description: Checks if there is an empty line after hook blocks.
  Enabled: true

RSpec/EmptyLineAfterSubject:
  Description: Checks if there is an empty line after subject block.
  Enabled: true

RSpec/ExampleLength:
  Description: Checks for long examples.
  Enabled: true
  Max: 5
  CountAsOne: []
  Exclude:
    - spec/system/*_spec.rb

RSpec/ExampleWithoutDescription:
  Description: Checks for examples without a description.
  Enabled: true
  EnforcedStyle: always_allow
  SupportedStyles:
    - always_allow
    - single_line_only
    - disallow

RSpec/ExcessiveDocstringSpacing:
  Description: Checks for excessive whitespace in example descriptions.
  Enabled: true

RSpec/ExampleWording:
  Description: Checks for common mistakes in example descriptions.
  Enabled: true
  CustomTransform:
    be: is
    BE: IS
    have: has
    HAVE: HAS
  IgnoredWords: []

RSpec/ExpectActual:
  Description: Checks for `expect(...)` calls containing literal values.
  Enabled: true
  Exclude:
    - spec/routing/**/*

RSpec/ExpectChange:
  Description: Checks for consistent style of change matcher.
  Enabled: true
  EnforcedStyle: method_call
  SupportedStyles:
    - method_call
    - block
  SafeAutoCorrect: false

RSpec/ExpectInHook:
  Description: Do not use `expect` in hooks such as `before`.
  Enabled: true

RSpec/ExpectOutput:
  Description: Checks for opportunities to use `expect { ... }.to output`.
  Enabled: true

RSpec/SpecFilePathFormat:
  Description: Checks that spec file paths are consistent and well-formed.
  Enabled: true
  Include:
    - "**/*_spec*rb*"
    - "**/spec/**/*"
  CustomTransform:
    RuboCop: rubocop
    RSpec: rspec
  IgnoreMethods: false

RSpec/SpecFilePathSuffix:
  Description: Checks that spec file paths are consistent and well-formed.
  Enabled: true
  Include:
    - "**/*_spec*rb*"
    - "**/spec/**/*"

RSpec/Focus:
  Description: Checks if examples are focused.
  Enabled: true

RSpec/HookArgument:
  Description: Checks the arguments passed to `before`, `around`, and `after`.
  Enabled: true
  EnforcedStyle: implicit
  SupportedStyles:
    - implicit
    - each
    - example

RSpec/HooksBeforeExamples:
  Description: Checks for before/around/after hooks that come after an example.
  Enabled: true

RSpec/IdenticalEqualityAssertion:
  Description: Checks for equality assertions with identical expressions on both sides.
  Enabled: true

RSpec/ImplicitBlockExpectation:
  Description: Check that implicit block expectation syntax is not used.
  Enabled: true

RSpec/ImplicitExpect:
  Description: Check that a consistent implicit expectation style is used.
  Enabled: true
  EnforcedStyle: is_expected
  SupportedStyles:
    - is_expected
    - should

RSpec/ImplicitSubject:
  Description: Checks for usage of implicit subject (`is_expected` / `should`).
  Enabled: true
  EnforcedStyle: single_line_only
  SupportedStyles:
    - single_line_only
    - single_statement_only
    - disallow

RSpec/InstanceSpy:
  Description: Checks for `instance_double` used with `have_received`.
  Enabled: true

RSpec/InstanceVariable:
  Description: Checks for instance variable usage in specs.
  Enabled: true
  AssignmentOnly: false

RSpec/ItBehavesLike:
  Description: Checks that only one `it_behaves_like` style is used.
  Enabled: true
  EnforcedStyle: it_behaves_like
  SupportedStyles:
    - it_behaves_like
    - it_should_behave_like

RSpec/IteratedExpectation:
  Description: Check that `all` matcher is used instead of iterating over an array.
  Enabled: true

RSpec/LeadingSubject:
  Description: Enforce that subject is the first definition in the test.
  Enabled: true

RSpec/LeakyConstantDeclaration:
  Description: Checks that no class, module, or constant is declared.
  Enabled: true

RSpec/LetBeforeExamples:
  Description: Checks for `let` definitions that come after an example.
  Enabled: true

RSpec/LetSetup:
  Description: Checks unreferenced `let!` calls being used for test setup.
  Enabled: true

RSpec/MessageChain:
  Description: Check that chains of messages are not being stubbed.
  Enabled: true

RSpec/MessageExpectation:
  Description: Checks for consistent message expectation style.
  Enabled: true
  EnforcedStyle: allow
  SupportedStyles:
    - allow
    - expect

RSpec/MessageSpies:
  Description: Checks that message expectations are set using spies.
  Enabled: true
  EnforcedStyle: have_received
  SupportedStyles:
    - have_received
    - receive

RSpec/MissingExampleGroupArgument:
  Description: Checks that the first argument to an example group is not empty.
  Enabled: true

RSpec/MultipleDescribes:
  Description: Checks for multiple top-level example groups.
  Enabled: true

RSpec/MultipleExpectations:
  Description: Checks if examples contain too many `expect` calls.
  Enabled: true
  Max: 1
  Exclude:
    - spec/system/*_spec.rb

RSpec/MultipleMemoizedHelpers:
  Description: Checks if example groups contain too many `let` and `subject` calls.
  Enabled: true
  AllowSubject: true
  Max: 10

RSpec/MultipleSubjects:
  Description: Checks if an example group defines `subject` multiple times.
  Enabled: true

RSpec/NamedSubject:
  Description: Checks for explicitly referenced test subjects.
  Enabled: true
  IgnoreSharedExamples: true

RSpec/NestedGroups:
  Description: Checks for nested example groups.
  Enabled: true
  Max: 3

RSpec/NotToNot:
  Description: Checks for consistent method usage for negating expectations.
  Enabled: true
  EnforcedStyle: not_to
  SupportedStyles:
    - not_to
    - to_not

RSpec/OverwritingSetup:
  Description: Checks if there is a let/subject that overwrites an existing one.
  Enabled: true

RSpec/Pending:
  Description: Checks for any pending or skipped examples.
  Enabled: true

RSpec/PredicateMatcher:
  Description: Prefer using predicate matcher over using predicate method directly.
  Enabled: true
  Strict: true
  EnforcedStyle: inflected
  AllowedExplicitMatchers: []
  SupportedStyles:
    - inflected
    - explicit
  SafeAutoCorrect: false

RSpec/ReceiveCounts:
  Description: Check for `once` and `twice` receive counts matchers usage.
  Enabled: true

RSpec/ReceiveNever:
  Description: Prefer `not_to receive(...)` over `receive(...).never`.
  Enabled: true

RSpec/RepeatedDescription:
  Description: Check for repeated description strings in example groups.
  Enabled: true

RSpec/RepeatedExample:
  Description: Check for repeated examples within example groups.
  Enabled: true

RSpec/RepeatedExampleGroupBody:
  Description: Check for repeated describe and context block body.
  Enabled: true

RSpec/RepeatedExampleGroupDescription:
  Description: Check for repeated example group descriptions.
  Enabled: true

RSpec/RepeatedIncludeExample:
  Description: Check for repeated include of shared examples.
  Enabled: true

RSpec/ReturnFromStub:
  Description: Checks for consistent style of stub's return setting.
  Enabled: true
  EnforcedStyle: and_return
  SupportedStyles:
    - and_return
    - block

RSpec/ScatteredLet:
  Description: Checks for let scattered across the example group.
  Enabled: true

RSpec/ScatteredSetup:
  Description: Checks for setup scattered across multiple hooks in an example group.
  Enabled: true

RSpec/SharedContext:
  Description: Checks for proper shared_context and shared_examples usage.
  Enabled: true

RSpec/SharedExamples:
  Description: Enforces use of string to titleize shared examples.
  Enabled: true

RSpec/SingleArgumentMessageChain:
  Description: Checks that chains of messages contain more than one element.
  Enabled: true

RSpec/StubbedMock:
  Description: Checks that message expectations do not have a configured response.
  Enabled: true

RSpec/SubjectDeclaration:
  Description: Ensure that subject is defined using subject helper.
  Enabled: true

RSpec/SubjectStub:
  Description: Checks for stubbed test subjects.
  Enabled: true

RSpec/UnspecifiedException:
  Description: Checks for a specified error in checking raised errors.
  Enabled: true

RSpec/VariableDefinition:
  Description: Checks that memoized helpers names are symbols or strings.
  Enabled: true
  EnforcedStyle: symbols
  SupportedStyles:
    - symbols
    - strings

RSpec/VariableName:
  Description: Checks that memoized helper names use the configured style.
  Enabled: true
  EnforcedStyle: snake_case
  SupportedStyles:
    - snake_case
    - camelCase
  AllowedPatterns: []

RSpec/VerifiedDoubles:
  Description: Prefer using verifying doubles over normal doubles.
  Enabled: true
  IgnoreNameless: true
  IgnoreSymbolicNames: false

RSpec/VoidExpect:
  Description: This cop checks void `expect()`.
  Enabled: true

RSpec/Yield:
  Description: This cop checks for calling a block within a stub.
  Enabled: true

Capybara:
  Enabled: true
  Include: *1

Capybara/CurrentPathExpectation:
  Description: Checks that no expectations are set on Capybara's `current_path`.
  Enabled: true

Capybara/VisibilityMatcher:
  Description: Checks for boolean visibility in capybara finders.
  Enabled: true

FactoryBot:
  Enabled: true
  Include: *1

FactoryBot/AttributeDefinedStatically:
  Description: Always declare attribute values as blocks.
  Enabled: true
  Include:
    - spec/factories.rb
    - spec/factories/**/*.rb
    - features/support/factories/**/*.rb

FactoryBot/CreateList:
  Description: Checks for create_list usage.
  Enabled: true
  Include:
    - "**/*_spec.rb"
    - "**/spec/**/*"
    - spec/factories.rb
    - spec/factories/**/*.rb
    - features/support/factories/**/*.rb
  EnforcedStyle: create_list
  SupportedStyles:
    - create_list
    - n_times

FactoryBot/FactoryClassName:
  Description: Use string value when setting the class attribute explicitly.
  Enabled: true
  Include:
    - spec/factories.rb
    - spec/factories/**/*.rb
    - features/support/factories/**/*.rb

FactoryBot/SyntaxMethods:
  Description: Use shorthands from `FactoryBot::Syntax::Methods` in your specs.
  Enabled: true
  SafeAutoCorrect: true

RSpecRails:
  Enabled: true
  Include: *1

RSpecRails/AvoidSetupHook:
  Description: Checks that tests use RSpec `before` hook over Rails `setup` method.
  Enabled: true

RSpecRails/HttpStatus:
  Description: Enforces use of symbolic or numeric value to describe HTTP status.
  Enabled: true
  EnforcedStyle: symbolic
  SupportedStyles:
    - numeric
    - symbolic
